{"version":3,"sources":["../../../src/utils/context.ts"],"names":["uuid","require","crypto","exports","X_CLOUD_TRACE_HEADER","SPAN_ID_RANDOM_BYTES","spanIdBuffer","Buffer","alloc","randomFillSync","randomBytes","spanRandomBuffer","W3C_TRACE_PARENT_HEADER","makeHeaderWrapper","req","headers","wrapper","setHeader","name","value","getHeader","getOrInjectContext","projectId","inject","defaultContext","toCloudTraceContext","traceContext","getContextFromTraceParent","cloudContext","getContextFromXCloudTrace","makeCloudTraceHeader","anyContext","context","trace","spanId","traceSampled","v4","replace","toString","headerWrapper","parseXCloudTraceHeader","parseTraceParentHeader","regex","match","_a","VERSION_PART","TRACE_ID_PART","PARENT_ID_PART","FLAGS_PART","TRACE_PARENT_REGEX","RegExp","parseInt"],"mappings":"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"}